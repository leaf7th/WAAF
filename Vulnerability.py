from enum import Enum

class Vul(Enum):
    SQLi = {"Shell" : (1, 1), "PE" : 0, "PR" : 0, "CONF" : 2}
    CMDi = {"Shell" : (1, 1), "PE" : 1, "PR" : 0, "CONF" : 2}
    XSS = {"Shell" : (0, 0), "PE" : 0, "PR" : 0, "CONF" : 1}
    CSRF = {"Shell" : (0, 0), "PE" : 0, "PR" : 1, "CONF" : 0}
    PATH = {"Shell": (0, 0), "PE": 0, "PR": 1, "CONF": 2}
    LFI = {"Shell": (0, 0), "PE": 0, "PR": 1, "CONF": 1}
    RFI = {"Shell" : (1, 0.5), "PE" : 1, "PR" : 0, "CONF" : 2}


    def des(self):
        return self.name, self.value
    def score(self):
        metrics = self.value
        score = metrics["Shell"][0] * 5 * metrics["Shell"][1] + metrics["PR"] * 4 + metrics["CONF"] * 3
        if metrics["PE"] == 1:
            score *= 1.5
        if self.name == "CSRF":
            return 0
        return score